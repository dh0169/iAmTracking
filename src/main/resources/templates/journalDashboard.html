<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>iAmTracking</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/src/journalDashboard.css">
</head>
<body>

<!-- every time you create a new page, add this navBar -->
<nav class="navbar navbar-dark bg-dark flex-column">
    <span class="navbar-brand mb-0 h1">Navigation Bar</span>
    <ul class="navbar-nav mr-auto">
        <li class="nav-item">
            <a class="nav-link" href="#">Journal Dashboard</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="#">Messages (empty)</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="#">Planner (empty)</a>
        </li>
        <ul class="navbar-nav second-nav">
            <li class="nav-item">
                <a class="nav-link" href="#">Profile (empty)</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Settings (empty)</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Logout (empty)</a>
            </li>
        </ul>
    </ul>
</nav>


<div class="container text-center">
    <div class="row justify-content-center align-items-left" style="max-height: 100vh;">
        <div class="col-md-6">
            <h1><strong>iAmTracking</strong></h1>
            <p class="tagline mb-4 text-left">Welcome <span th:text="${phoneNumber}">[Phone #]</span>!</p>
            <div class="chat-container" id="chat-container"></div>
            <div>
                <label for="calendarDate">Select Date:</label>
                <input th:if="${date}" type="date" id="calendarDate" th:value="${date}">

                <input th:unless="${date}" type="date" id="calendarDate">

                <button onclick="updateJournal()" class="btn btn-primary">View Entry</button>
            </div>
            <div class="row mt-2 rounded overflow-auto" style="background: white; min-height: 70vh; min-width: 50vw" >
                <div class="col-md-12 ">
                    <label for="outputText">Chatbox:</label>
                    <div id="outputText">
                        <!-- Messages will be dynamically added here -->
                        <div class="message"  th:classappend="${message.type}" th:each="message : ${messages}">
                            <div th:text="${message.body}"></div>
                            <div class="timestamp" th:text="${message.received}"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    #outputText::first-line {
        font-weight: bold;
    }
</style>




<script>
    document.addEventListener('DOMContentLoaded', function () {
        const jsonData = document.getElementById('journalEntryJson').textContent;
<!--        const messages = JSON.parse(jsonData);-->
        console.log(jsonData); //Put in date from date selecter and update
        const chatContainer = document.getElementById('outputText');
        chatContainer.textContent = "";
        document.getElementById('journalEntryJson').textContent = "";

<!--        messages['2024-05-03'].forEach(msg => {-->
<!--            const messageElement = document.createElement('div');-->
<!--            messageElement.classList.add('message', msg.type === 'sent' ? 'sent' : 'inbox');-->
<!--            messageElement.innerHTML = `-->
<!--                <div>${msg.body}</div>-->
<!--                <div class="timestamp">${msg.received}</div>-->
<!--            `;-->
<!--            chatContainer.appendChild(messageElement);-->
<!--        });-->
    });

    function updateJournal() {
        const calendarDate = document.getElementById("calendarDate").value;
        // Implement the fetch call here to update the chat based on the selected date
    }
</script>

<style>
    /* Chatbox styling */
    #chatbox {
        background-color: #ffddc1; /* Warm orange background */
        border: 1px solid #e38d6d; /* Border color */
        border-radius: 10px;
        padding: 10px;
        overflow-y: auto; /* Enable vertical scrolling */
        max-height: 400px; /* Limit height to prevent excessive scrolling */
    }

    /* Styling for incoming messages */
    .message.sent {
        background-color: #f7e0d4; /* Light orange */
        border-radius: 10px;
        padding: 8px;
        margin-bottom: 10px;
        text-align: left;
        max-width: 70%; /* Smaller width */
        float: left; /* Align to the left */
        clear: both; /* Clear the float */
    }

    /* Styling for outgoing messages */
    .message.inbox {
        background-color: #ffe8d6; /* Light peach */
        border-radius: 10px;
        padding: 8px;
        margin-bottom: 10px;
        text-align: right;
        max-width: 70%; /* Smaller width */
        float: right; /* Align to the right */
        clear: both; /* Clear the float */
    }

    /* Styling for message text */
    .message div {
        font-size: 14px;
        color: #333;
        word-wrap: break-word; /* Allow long words to break */
    }

    /* Styling for timestamp */
    .timestamp {
        font-size: 12px;
        color: #777;
    }
</style>


<!-- Bootstrap JS, Popper.js, and jQuery -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</body>
</html>